<html><head><base href="data:text/html">
<meta charset="UTF-8">
<title>Reproductor HLS Protegido con Bot Verificador</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
  body {
    margin: 0;
    padding: 20px;
    background: #000;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    font-family: Arial, sans-serif;
    color: white;
  }

  .access-denied {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    flex-direction: column;
    gap: 20px;
  }

  .main-container {
    display: flex;
    gap: 20px;
    width: 100%;
    max-width: 1200px;
  }

  .player-container {
    flex: 1;
    background: #111;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    margin-bottom: 20px;
  }

  #video-player {
    width: 100%;
    height: auto;
    max-height: 450px;
  }

  .controls {
    padding: 15px;
    background: #1a1a1a;
    color: white;
    text-align: center;
  }

  .status {
    color: #00ff00;
    font-size: 14px;
    margin: 10px 0;
  }

  .playlist {
    width: 300px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .playlist-item {
    padding: 10px;
    background: #222;
    color: white;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.3s;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .playlist-item:hover {
    background: #333;
  }

  .status-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-left: 10px;
  }

  .status-online {
    background: #00ff00;
  }

  .status-offline {
    background: #ff0000;
  }

  .bot-container {
    width: 100%;
    max-width: 1200px;
    background: #111;
    border-radius: 8px;
    padding: 15px;
    margin: 20px 0;
  }

  .bot-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }

  .check-button {
    background: #2196F3;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.3s;
  }

  .check-button:hover {
    background: #1976D2;
  }

  .bot-log {
    background: #1a1a1a;
    padding: 10px;
    border-radius: 4px;
    font-family: monospace;
    height: 150px;
    overflow-y: auto;
    margin-top: 10px;
  }

  .log-entry {
    margin: 5px 0;
    padding: 5px;
    border-left: 3px solid;
  }

  .log-success {
    border-color: #00ff00;
  }

  .log-error {
    border-color: #ff0000;
  }
</style>
</head>
<body>

<div id="accessDenied" class="access-denied" style="display: none;">
  <h1>Acceso Denegado</h1>
  <p>No tienes permiso para acceder a este contenido.</p>
</div>

<div class="main-container">
  <div class="player-container">
    <video id="video-player" controls></video>
    <div class="controls">
      <div class="status">StreamGuard Activado</div>
    </div>
  </div>

  <div class="playlist" id="playlist">
    <div class="playlist-item" data-src="https://z29vzc.fubohd.com/dsports/index.m3u8?token=732131dc341b2399c873f9f0d59ef5702ec3e955-e0-1736762882-1736726882">
      Win+ <span class="status-indicator"></span>
    </div>
    <div class="playlist-item" data-src="https://doc.pricesaskeloadsc.com/dsports/tracks-v1a1/mono.m3u8?token=6c5d20295d85a59ec0d68df3b75d527c3353af4b-f2-1736762168-1736726168">
      Dsports <span class="status-indicator"></span>
    </div>
    <div class="playlist-item" data-src="https://example.com/espn.m3u8">
      ESPN <span class="status-indicator"></span>
    </div>
    <div class="playlist-item" data-src="https://example.com/espn2.m3u8">
      ESPN 2 <span class="status-indicator"></span>
    </div>
    <div class="playlist-item" data-src="https://example.com/espn3.m3u8">
      ESPN 3 <span class="status-indicator"></span>
    </div>
    <div class="playlist-item" data-src="https://example.com/espn4.m3u8">
      ESPN 4 <span class="status-indicator"></span>
    </div>
    <div class="playlist-item" data-src="https://example.com/espnextra.m3u8">
      ESPN EXTRA <span class="status-indicator"></span>
    </div>
    <div class="playlist-item" data-src="https://example.com/espnpremium.m3u8">
      ESPN Premium <span class="status-indicator"></span>
    </div>
  </div>
</div>

<div class="bot-container">
  <div class="bot-header">
    <h3>Bot Verificador de Streams</h3>
    <button class="check-button" onclick="checkAllStreams()">Verificar Todos los Canales</button>
  </div>
  <div class="bot-log" id="botLog"></div>
</div>

<script>document.addEventListener('DOMContentLoaded', function () {
  function checkReferrer() {
    const allowedOrigin = "https://carlos23asd.github.io/dn1/";
    const referrer = document.referrer;
    if (referrer !== "" && !referrer.startsWith(allowedOrigin)) {
      document.getElementById('accessDenied').style.display = 'flex';
      document.querySelector('.main-container').style.display = 'none';
      document.querySelector('.bot-container').style.display = 'none';
      return false;
    }
    return true;
  }
  if (!checkReferrer()) {
    return;
  }
  const video = document.getElementById('video-player');
  const playlistItems = document.querySelectorAll('.playlist-item');
  const botLog = document.getElementById('botLog');
  document.addEventListener('contextmenu', function (e) {
    e.preventDefault();
  });
  document.addEventListener('mousedown', function (e) {
    if (e.button === 0) {
      e.preventDefault();
    }
  });
  function logMessage(message, isSuccess) {
    const entry = document.createElement('div');
    entry.className = `log-entry ${isSuccess ? 'log-success' : 'log-error'}`;
    entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
    botLog.appendChild(entry);
    botLog.scrollTop = botLog.scrollHeight;
  }
  async function checkStream(url) {
    try {
      const response = await fetch(url, {
        method: 'HEAD',
        headers: {
          'User-Agent': 'StreamGuard/1.0',
          'X-Stream-Guard': 'enabled',
          'X-Stream-Guard-Version': '1.0',
          'X-Stream-Guard-Permission': 'granted',
          'Allow-Access-Content': 'true',
          'Content-Access': 'allowed',
          'Referer': 'about:blank',
          'Origin': null
        },
        mode: 'cors',
        credentials: 'omit'
      });
      return response.ok;
    } catch (error) {
      return false;
    }
  }
  async function measureConnectionSpeed() {
    const startTime = performance.now();
    const testFile = 'https://www.google.com/images/phd/px.gif';
    try {
      const response = await fetch(testFile);
      const endTime = performance.now();
      const duration = endTime - startTime;
      const speed = response.headers.get('content-length') * 8 / (duration / 1000);
      return speed;
    } catch (error) {
      console.error('Error measuring speed:', error);
      return 1000000;
    }
  }
  window.checkAllStreams = async function () {
    logMessage('Iniciando verificación de streams...', true);
    for (const item of playlistItems) {
      const url = item.getAttribute('data-src');
      const channelName = item.textContent.trim().split(' ')[0];
      const statusIndicator = item.querySelector('.status-indicator');
      logMessage(`Verificando canal: ${channelName}...`, true);
      try {
        const isWorking = await checkStream(url);
        statusIndicator.className = `status-indicator ${isWorking ? 'status-online' : 'status-offline'}`;
        logMessage(`Canal ${channelName}: ${isWorking ? 'FUNCIONANDO' : 'NO FUNCIONA'}`, isWorking);
      } catch (error) {
        statusIndicator.className = 'status-indicator status-offline';
        logMessage(`Error al verificar ${channelName}: ${error.message}`, false);
      }
    }
    logMessage('Verificación completada', true);
  };
  const securityConfig = {
    enableStreamGuard: true,
    streamGuardVersion: '1.0',
    streamGuardPermission: 'granted',
    maskUserAgent: true,
    hideReferrer: true,
    allowContentAccess: true
  };
  function cleanupResources() {
    if (window.gc) {
      window.gc();
    }
    performance.clearResourceTimings();
  }
  function setupStreamGuard() {
    const originalFetch = window.fetch;
    window.fetch = function (...args) {
      if (args[1] && args[1].headers) {
        args[1].headers = new Headers({
          'User-Agent': 'StreamGuard/1.0',
          'X-Stream-Guard': 'enabled',
          'X-Stream-Guard-Version': '1.0',
          'X-Stream-Guard-Permission': 'granted',
          'Allow-Access-Content': 'true',
          'Content-Access': 'allowed',
          'SEC-FETCH-SITE': 'same-origin',
          'SEC-FETCH-MODE': 'cors'
        });
      }
      return originalFetch.apply(this, args);
    };
  }
  async function loadVideo(src) {
    if (Hls.isSupported()) {
      setupStreamGuard();
      const connectionSpeed = await measureConnectionSpeed();
      const hlsConfig = {
        enableWorker: true,
        lowLatencyMode: true,
        backBufferLength: 30,
        xhrSetup: function (xhr, url) {
          xhr.withCredentials = false;
          xhr.setRequestHeader('X-Stream-Guard', 'enabled');
          xhr.setRequestHeader('X-Stream-Guard-Version', '1.0');
          xhr.setRequestHeader('X-Stream-Guard-Permission', 'granted');
          xhr.setRequestHeader('Cache-Control', 'no-store');
        }
      };
      if (connectionSpeed > 5000000) {
        hlsConfig.maxBufferSize = 30 * 1000 * 1000;
        hlsConfig.maxBufferLength = 30;
        hlsConfig.maxMaxBufferLength = 60;
      } else if (connectionSpeed > 2000000) {
        hlsConfig.maxBufferSize = 15 * 1000 * 1000;
        hlsConfig.maxBufferLength = 20;
        hlsConfig.maxMaxBufferLength = 40;
      } else {
        hlsConfig.maxBufferSize = 8 * 1000 * 1000;
        hlsConfig.maxBufferLength = 10;
        hlsConfig.maxMaxBufferLength = 20;
      }
      const hls = new Hls(hlsConfig);
      hls.loadSource(src);
      hls.attachMedia(video);
      hls.on(Hls.Events.MANIFEST_PARSED, function () {
        video.play();
      });
      hls.on(Hls.Events.ERROR, function (event, data) {
        if (data.fatal) {
          switch (data.type) {
            case Hls.ErrorTypes.NETWORK_ERROR:
              hls.startLoad();
              break;
            case Hls.ErrorTypes.MEDIA_ERROR:
              hls.recoverMediaError();
              break;
            default:
              hls.destroy();
              break;
          }
        }
      });
      setInterval(cleanupResources, 30000);
      video.addEventListener('pause', function () {
        cleanupResources();
      });
    }
    video.addEventListener('loadstart', function () {
      video.crossOrigin = "anonymous";
    });
    video.addEventListener('contextmenu', function (e) {
      e.preventDefault();
    });
    video.addEventListener('canplay', function () {
      video.play().catch(function (error) {
        console.log("Reproducción automática bloqueada:", error);
      });
    });
  }
  playlistItems.forEach(item => {
    item.addEventListener('click', function () {
      const src = this.getAttribute('data-src');
      loadVideo(src);
    });
  });
  loadVideo(playlistItems[0].getAttribute('data-src'));
  checkAllStreams();
});</script>

</body></html>
